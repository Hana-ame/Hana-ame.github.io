"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[89],{5089:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});var r=s(5043);class n{constructor(t){this.endpoint=void 0,this.endpoint=t}async fetch(t,e){const s=new URL(t),r=new URL(s);r.protocol="https:",r.host=this.endpoint;const n={...e},a=new Headers(n.headers);return a.set("X-Host",s.hostname),a.set("X-Scheme",s.protocol.slice(0,-1)),n.headers=a,fetch(r.toString(),n)}}var a=s(579);const o=t=>{let{imageUrl:e,text:s}=t;const[n,o]=(0,r.useState)(""),[i,c]=(0,r.useState)("");return(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("img",{src:e,alt:"\u9884\u89c8",className:"w-1/2 h-auto",referrerPolicy:"no-referrer"}),(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(e.replace(/^https:/,"http:")+"\n").then((()=>{o("\u56fe\u7247\u5730\u5740\u5df2\u590d\u5236: "+e.replace(/^https:/,"http:")),setTimeout((()=>o("")),3e3)})).catch((t=>{console.error("\u590d\u5236\u5931\u8d25:",t),o("\u590d\u5236\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),setTimeout((()=>o("")),3e3)}))},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"\u590d\u5236\u56fe\u7247\u5730\u5740"}),n&&(0,a.jsx)("p",{className:"mt-2 text-green-500",children:n})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:async()=>{c("\u53d1\u9001\u4e2d...");const t={"Content-Type":"application/json"},r=JSON.stringify({p:e.replace(/^https:/,"http:"),txt:s});try{const s=await fetch("https://moonchan.xyz/api/v2/?bid=104&tid=135803",{method:"POST",credentials:"include",headers:t,body:r});if(s.ok)c("\u53d1\u9001\u6210\u529f\uff01"),setTimeout((()=>c("")),3e3);else{const t=await s.text();console.error("\u53d1\u9001\u5230\u6708\u5c9b\u5931\u8d25\u54cd\u5e94:",s.status,s.statusText,t),c(`\u53d1\u9001\u5931\u8d25: ${s.status} ${s.statusText} - ${t.substring(0,100)}...`),setTimeout((()=>c("")),5e3)}fetch("https://moonchan.xyz/api/v2/random?table=bilicover",{method:"POST",credentials:"include",headers:t,body:e.replace(/^https:/,"http:")})}catch(n){console.error("\u53d1\u9001\u5230\u6708\u5c9b\u65f6\u53d1\u751f\u9519\u8bef:",n),c(`\u53d1\u9001\u5931\u8d25: ${n.message}`),setTimeout((()=>c("")),5e3)}},className:"bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600",children:"\u53d1\u9001\u5230\u6708\u5c9b"}),i&&(0,a.jsx)("p",{className:"mt-2 "+(i.includes("\u5931\u8d25")?"text-red-500":"text-green-500"),children:i})]})]})]})},i=t=>{let{id:e,text:s}=t;const[i,c]=(0,r.useState)(null),[l,h]=(0,r.useState)(!0),[d,p]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{try{const t=await new n("ex.moonchan.xyz").fetch(`https://apiv2.magecorn.com/bilicover/get?type=bv&id=${e}&client=2.6.0`,{method:"GET"});if(!t.ok)throw new Error("Network response was not ok"+t.statusText.toString());const s=await t.json();if(!s||!s.url)throw new Error("\u7ed3\u679c\u4e2d\u672a\u627e\u5230 'url' \u5c5e\u6027");c(s.url)}catch(t){p(t.message)}finally{h(!1)}})()}),[e]),l?(0,a.jsx)("div",{children:"Loading..."}):d?(0,a.jsxs)("div",{children:["Error: ",d]}):(0,a.jsx)(o,{imageUrl:i,text:s})},c=t=>{let{id:e,text:s}=t;const[i,c]=(0,r.useState)(null),[l,h]=(0,r.useState)(!0),[d,p]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{try{const t=await new n("ex.moonchan.xyz").fetch(`https://apiv2.magecorn.com/bilicover/get?type=live&id=${e}&client=2.6.0`,{method:"GET"});if(!t.ok)throw new Error("Network response was not ok"+t.statusText.toString());const s=await t.json();if(!s||!s.url)throw new Error("\u7ed3\u679c\u4e2d\u672a\u627e\u5230 'url' \u5c5e\u6027");c(s.url)}catch(t){p(t.message)}finally{h(!1)}})()}),[e]),l?(0,a.jsx)("div",{children:"Loading..."}):d?(0,a.jsxs)("div",{children:["Error: ",d]}):(0,a.jsx)(o,{imageUrl:i,text:s})},l=t=>{let{id:e,text:s}=t;const[o,l]=(0,r.useState)(null),[h,d]=(0,r.useState)(null),[p,u]=(0,r.useState)(!0),[x,m]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{try{const t=await new n("ex.moonchan.xyz").fetch(`https://apiv2.magecorn.com/bilicover/get?type=b23&id=${e}&client=2.6.0`,{method:"GET"});if(!t.ok)throw new Error("Network response was not ok"+t.statusText.toString());const s=await t.json();if(!s||!s.result)throw new Error("\u7ed3\u679c\u4e2d\u672a\u627e\u5230 'result' \u5c5e\u6027");const r=s.result,a=new URL(r),o=a.pathname.split("/video/")[1],i=a.pathname.split("/")[1];l(o),d(i)}catch(t){m(t.message)}finally{u(!1)}})()}),[e]),p?(0,a.jsx)("div",{children:"Loading..."}):x?(0,a.jsxs)("div",{children:["Error: ",x]}):o?(0,a.jsx)(i,{id:o,text:s}):(0,a.jsx)(c,{id:h,text:s})};var h=s(2711),d=s(5857);const p=()=>{const[t,e]=(0,r.useState)(""),[s,n]=(0,r.useState)(""),[o,p]=(0,r.useState)(""),[u,x]=(0,r.useState)(""),m=t=>{const e=t.match(/https?:\/\/(?:www\.)?b23\.tv\/(\w+)/),s=t.match(/https?:\/\/(?:www\.)?bilibili\.com\/video\/(\w+)/),r=t.match(/https?:\/\/live\.bilibili\.com\/(\w+)/);n(e?e[1]:""),p(s?s[1]:""),x(r?r[1]:"")},w=t=>{t.preventDefault();const s=(t.clipboardData||window.clipboardData).getData("Text");e(s),m(s)};return(0,r.useEffect)((()=>(window.addEventListener("paste",w),()=>{window.removeEventListener("paste",w)}))),(0,a.jsxs)(h.g,{children:[(0,a.jsx)(d.A,{}),(0,a.jsxs)("div",{className:"h-full",onDrop:t=>{t.preventDefault();const s=t.dataTransfer.getData("text");e(s),m(s)},onDragOver:t=>{t.preventDefault()},children:[(0,a.jsx)("input",{type:"text",value:t,onChange:t=>{const s=t.target.value;e(s),m(s)},onMouseEnter:t=>{t.target.select()},placeholder:"\u8f93\u5165 URL, \u6216\u8005\u76f4\u63a5\u6309 Ctrl+V, \u6216\u8005\u62d6\u52a8\u8fde\u63a5\u5230\u6b64\u9875\u9762",style:{width:"100%",padding:"8px",marginBottom:"10px"}}),s&&(0,a.jsx)(l,{id:s,text:t}),o&&(0,a.jsx)(i,{id:o,text:t}),u&&(0,a.jsx)(c,{id:u,text:t}),(0,a.jsxs)("div",{children:["\u540e\u7aef\u652f\u6301(\u65e0\u65ad):",(0,a.jsx)("a",{className:"text-blue-500 hover:text-green-500 underline",href:"https://bilicover.magecorn.com/help",children:"https://bilicover.magecorn.com/help"})]})]})]})}}}]);
//# sourceMappingURL=89.6ae2bebf.chunk.js.map